{"ast":null,"code":"import ApolloServer, { gql } from \"apollo-server-micro\";\n/**\n * Executes a shell command and return it as a Promise.\n * @param cmd {string}\n * @return {Promise<string>}\n */\n\nfunction execShellCommand(cmd) {\n  const exec = require('child_process').exec;\n\n  return new Promise((resolve, reject) => {\n    exec(cmd, (error, stdout, stderr) => {\n      if (error) {\n        console.warn(error);\n      }\n\n      resolve(stdout ? stdout : stderr);\n    });\n  });\n}\n\nconst typeDefs = gql`\n  scalar Date\n\n  type Task {\n    uuid: ID!\n    description: String\n    entry: String\n    modified: String\n    status: String\n    urgency: Float\n  }\n\n  type Query {\n    tasks: [Task]\n  }\n`;\nconst resolvers = {\n  Query: {\n    tasks: async () => {\n      const x = await execShellCommand('/usr/bin/task export');\n      console.log(x);\n      return JSON.parse(x);\n    }\n  }\n};\nconst apolloServer = new ApolloServer({\n  typeDefs,\n  resolvers\n});\nconst handler = apolloServer.createHandler({\n  path: \"/api/hello\"\n});\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\nexport default handler;","map":{"version":3,"sources":["/storage/code/github/simonwjackson/task-warrior-react/pages/api/graphql.js"],"names":["ApolloServer","gql","execShellCommand","cmd","exec","require","Promise","resolve","reject","error","stdout","stderr","console","warn","typeDefs","resolvers","Query","tasks","x","log","JSON","parse","apolloServer","handler","createHandler","path","config","api","bodyParser"],"mappings":"AAAA,OAAOA,YAAP,IAAsBC,GAAtB,QAAgC,qBAAhC;AAEA;;;;;;AAKA,SAASC,gBAAT,CAA0BC,GAA1B,EAA+B;AAC9B,QAAMC,IAAI,GAAGC,OAAO,CAAC,eAAD,CAAP,CAAyBD,IAAtC;;AACA,SAAO,IAAIE,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACvCJ,IAAAA,IAAI,CAACD,GAAD,EAAM,CAACM,KAAD,EAAQC,MAAR,EAAgBC,MAAhB,KAA2B;AACpC,UAAIF,KAAJ,EAAW;AACVG,QAAAA,OAAO,CAACC,IAAR,CAAaJ,KAAb;AACA;;AACDF,MAAAA,OAAO,CAACG,MAAM,GAAEA,MAAF,GAAWC,MAAlB,CAAP;AACA,KALG,CAAJ;AAMA,GAPM,CAAP;AAQA;;AAED,MAAMG,QAAQ,GAAGb,GAAI;;;;;;;;;;;;;;;CAArB;AAkBA,MAAMc,SAAS,GAAG;AAChBC,EAAAA,KAAK,EAAE;AACHC,IAAAA,KAAK,EAAE,YAAY;AACf,YAAMC,CAAC,GAAG,MAAMhB,gBAAgB,CAAC,sBAAD,CAAhC;AACAU,MAAAA,OAAO,CAACO,GAAR,CAAYD,CAAZ;AACA,aAAOE,IAAI,CAACC,KAAL,CAAWH,CAAX,CAAP;AACH;AALE;AADS,CAAlB;AAUA,MAAMI,YAAY,GAAG,IAAItB,YAAJ,CAAiB;AAClCc,EAAAA,QADkC;AAElCC,EAAAA;AAFkC,CAAjB,CAArB;AAKA,MAAMQ,OAAO,GAAGD,YAAY,CAACE,aAAb,CAA2B;AAAEC,EAAAA,IAAI,EAAE;AAAR,CAA3B,CAAhB;AAEA,OAAO,MAAMC,MAAM,GAAG;AACpBC,EAAAA,GAAG,EAAE;AACHC,IAAAA,UAAU,EAAE;AADT;AADe,CAAf;AAMP,eAAeL,OAAf","sourcesContent":["import ApolloServer, {gql} from \"apollo-server-micro\"\n\n/**\n * Executes a shell command and return it as a Promise.\n * @param cmd {string}\n * @return {Promise<string>}\n */\nfunction execShellCommand(cmd) {\n const exec = require('child_process').exec;\n return new Promise((resolve, reject) => {\n  exec(cmd, (error, stdout, stderr) => {\n   if (error) {\n    console.warn(error);\n   }\n   resolve(stdout? stdout : stderr);\n  });\n });\n}\n\nconst typeDefs = gql`\n  scalar Date\n\n  type Task {\n    uuid: ID!\n    description: String\n    entry: String\n    modified: String\n    status: String\n    urgency: Float\n  }\n\n  type Query {\n    tasks: [Task]\n  }\n`;\n\n\nconst resolvers = {\n  Query: {\n      tasks: async () => {\n          const x = await execShellCommand('/usr/bin/task export')\n          console.log(x)\n          return JSON.parse(x)\n      }\n  },\n};\n\nconst apolloServer = new ApolloServer({\n    typeDefs,\n    resolvers\n})\n\nconst handler = apolloServer.createHandler({ path: \"/api/hello\" });\n\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}